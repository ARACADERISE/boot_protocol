org 0x7C00
use16

xor ax, ax
mov es, ax
mov ds, ax

cli
mov bp, 0x7C00
mov sp, bp
mov ss, ax
sti

mov ax, [Info.second_stage_addr]
mov es, ax
xor bx, bx

mov ah, 0x02
mov al, [Info.second_stage_size]
mov ch, 0x00
mov cl, [Info.sector]
mov dh, 0x00
mov dl, 0x80
int 0x13
jc failed

mov ax, [Info.second_stage_size]
add [Info.sector], ax
mov [Info.sector], ax

mov ax, [Info.kernel_addr]
mov es, ax
xor bx, bx

mov ah, 0x02
mov al, [Info.kernel_size]
mov ch, 0x00
mov cl, [Info.sector]
mov dh, 0x00
mov dl, 0x80
int 0x13
jc failed

mov ax, [Info.kernel_size]
add [Info.sector], ax
mov ax, [Info.sector]
mov [sector_addr], ax